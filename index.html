<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>McHenry Honor Board</title>

<style>
  body {
    margin: 0;
    background: black;
    color: white;
    font-family: Arial, sans-serif;
    overflow: hidden;
  }

  .header-logos {
    display: flex;
    justify-content: center;
    gap: 60px;
    padding: 20px 0;
  }

  .header-logos img {
    height: 120px;
  }

  .scroll-wrapper {
    position: relative;
    height: calc(100vh - 180px);
    overflow: hidden;
  }

  #scrollContent {
    position: absolute;
    width: 100%;
  }

  .pair {
    display: flex;
    width: 100%;
    padding: 20px 0;
  }

  .column {
    width: 50%;
    padding: 0 40px;
    box-sizing: border-box;
  }

  .category-title {
    font-size: 42px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 15px;
    text-transform: uppercase;
  }

  .entry {
    font-size: 32px;
    padding: 6px 0;
    text-align: center;
  }

  @keyframes scroll-up {
    from { transform: translateY(0); }
    to   { transform: translateY(-50%); }
  }
</style>
</head>

<body>

<div class="header-logos">
  <img src="mchenry-logo.png">
  <img src="boom-logo.png">
</div>

<div class="scroll-wrapper">
  <div id="scrollContent">

    <div id="stack">

      <!-- PAIR 1 -->
      <div class="pair">
        <div class="column" id="cat-300">
          <div class="category-title">300 Games</div>
          <div class="category-entries"></div>
        </div>

        <div class="column" id="cat-800">
          <div class="category-title">800 Series</div>
          <div class="category-entries"></div>
        </div>
      </div>

      <!-- PAIR 2 -->
      <div class="pair">
        <div class="column" id="cat-1100">
          <div class="category-title">1100 Series</div>
          <div class="category-entries"></div>
        </div>

        <div class="column" id="cat-11">
          <div class="category-title">11 in a Row</div>
          <div class="category-entries"></div>
        </div>
      </div>

    </div>

    <div id="stack-duplicate"></div>

  </div>
</div>

<script>
  /* ============================
     1. GOOGLE SHEETS CSV URLS
     ============================ */
  const URL_300  = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTo4pC3erQX6RWtulE08AgfjpGAeCgG4QCB1JvM005F21JrpD1IIdpE1axoNQN19pJDqGICriWnvcUA/pub?gid=0&single=true&output=csv";
  const URL_11   = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTo4pC3erQX6RWtulE08AgfjpGAeCgG4QCB1JvM005F21JrpD1IIdpE1axoNQN19pJDqGICriWnvcUA/pub?gid=1645007257&single=true&output=csv";
  const URL_800  = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTo4pC3erQX6RWtulE08AgfjpGAeCgG4QCB1JvM005F21JrpD1IIdpE1axoNQN19pJDqGICriWnvcUA/pub?gid=288383571&single=true&output=csv";
  const URL_1100 = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTo4pC3erQX6RWtulE08AgfjpGAeCgG4QCB1JvM005F21JrpD1IIdpE1axoNQN19pJDqGICriWnvcUA/pub?gid=1815197466&single=true&output=csv";

  /* ============================
     2. CSV FETCH + PARSE
     ============================ */
  async function fetchCsv(url) {
    const res = await fetch(url);
    const text = await res.text();
    const lines = text.trim().split(/\r?\n/);
    const rows = lines.map(line => line.split(","));
    const header = rows[0];
    const dataRows = rows.slice(1);

    const colFirst = header.indexOf("FirstName");
    const colLast  = header.indexOf("LastName");
    const colScore = header.indexOf("Score");

    return dataRows
      .filter(r => r[colFirst] || r[colLast])
      .map(r => ({
        first: (r[colFirst] || "").trim(),
        last:  (r[colLast]  || "").trim(),
        score: (r[colScore] || "").trim()
      }));
  }

  /* ============================
     3. RENDER FUNCTIONS
     ============================ */

  function render300Games(entries, container) {
    const counts = new Map();
    entries.forEach(e => {
      const name = `${e.first} ${e.last}`.trim();
      if (!name) return;
      counts.set(name, (counts.get(name) || 0) + 1);
    });

    const sorted = Array.from(counts.entries())
      .sort((a, b) => b[1] - a[1] || a[0].localeCompare(b[0]));

    container.innerHTML = "";
    sorted.forEach(([name, count]) => {
      const div = document.createElement("div");
      div.className = "entry";
      div.innerHTML = `<span class="count">${count}×</span> — ${name}`;
      container.appendChild(div);
    });
  }

  function renderScoreList(entries, container) {
    const sorted = entries
      .filter(e => e.first || e.last)
      .sort((a, b) => {
        const nameA = `${a.last} ${a.first}`.trim().toLowerCase();
        const nameB = `${b.last} ${b.first}`.trim().toLowerCase();
        return nameA.localeCompare(nameB);
      });

    container.innerHTML = "";
    sorted.forEach(e => {
      const name = `${e.first} ${e.last}`.trim();
      const text = e.score ? `${name} — ${e.score}` : name;
      const div = document.createElement("div");
      div.className = "entry";
      div.textContent = text;
      container.appendChild(div);
    });
  }

  /* ============================
     4. MAIN LOAD + SCROLL SETUP
     ============================ */
  window.addEventListener('load', async () => {

    const cat300  = document.querySelector("#cat-300 .category-entries");
    const cat11   = document.querySelector("#cat-11 .category-entries");
    const cat800  = document.querySelector("#cat-800 .category-entries");
    const cat1100 = document.querySelector("#cat-1100 .category-entries");

    try {
      const [data300, data11, data800, data1100] = await Promise.all([
        fetchCsv(URL_300),
        fetchCsv(URL_11),
        fetchCsv(URL_800),
        fetchCsv(URL_1100)
      ]);

      render300Games(data300, cat300);
      renderScoreList(data11, cat11);
      renderScoreList(data800, cat800);
      renderScoreList(data1100, cat1100);

    } catch (e) {
      console.error("Error loading honor board data:", e);
    }

    // SCROLL LOGIC — now delayed 3 seconds
    const content = document.getElementById('scrollContent');
    const wrapper = document.querySelector('.scroll-wrapper');
    const stack = document.getElementById('stack');
    const duplicate = document.getElementById('stack-duplicate');

    duplicate.innerHTML = stack.innerHTML;

    const contentHeight = content.offsetHeight;
    const wrapperHeight = wrapper.offsetHeight;

    const speed = 20;
    const distance = contentHeight / 2 + wrapperHeight;
    const duration = distance / speed;

    content.style.transform = "translateY(0)";

    setTimeout(() => {
      content.style.animation = `scroll-up ${duration}s linear infinite`;
    }, 3000);

  });
</script>

</body>
</html>

